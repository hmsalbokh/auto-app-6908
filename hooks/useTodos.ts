import { useState, useEffect } from 'react'; import { Todo, Priority } from '../types/todo'; export function useTodos() { const [todos, setTodos] = useState<Todo[]>([]); const [isLoaded, setIsLoaded] = useState(false); useEffect(() => { const saved = localStorage.getItem('todos-app'); if (saved) setTodos(JSON.parse(saved)); setIsLoaded(true); }, []); useEffect(() => { if (isLoaded) localStorage.setItem('todos-app', JSON.stringify(todos)); }, [todos, isLoaded]); const addTodo = (text: string, priority: Priority) => { const newTodo: Todo = { id: crypto.randomUUID(), text, completed: false, priority, createdAt: Date.now() }; setTodos([newTodo, ...todos]); }; const toggleTodo = (id: string) => { setTodos(todos.map(t => t.id === id ? { ...t, completed: !t.completed } : t)); }; const deleteTodo = (id: string) => { setTodos(todos.filter(t => t.id !== id)); }; return { todos, addTodo, toggleTodo, deleteTodo, isLoaded }; }